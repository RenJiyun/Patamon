{% if include.active_for_nested %}
  {% assign first_component_of_current_url = page.url | split: '/' | slice: 0, 2 | join: '/' | append: '/' %}
  {% assign first_component_of_link_url = include.url | split: '/' | slice: 0, 2 | join: '/' | append: '/' %}
  {% if first_component_of_current_url == first_component_of_link_url %}
    {% assign active_nested = true %}
  {% else %}
    {% assign active_nested = false %}
  {% endif %}
{% endif %}

{% if active_nested or page.url == include.url %}
  <a class="active {{ include.htmlclass }}" href="{{ include.url }}">{{ include.title }}</a>
{% else %}
  <a class="{{ include.htmlclass }}" href="{{ include.url }}">{{ include.title }}</a>
{% endif %}

{% assign active_nested = false %}
