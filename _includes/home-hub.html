{% assign projects = site.projects | where_exp: "item", "item.home_url != nil" %}

<div class="underlay top-background" role="presentation">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none">
    <polygon fill="white" points="0,0 100,0 100,60 0,100"/>
  </svg>

  {% assign featured_projects = projects | where: "featured", true %}
  {% assign num_featured_projects = featured_projects | size %}
  {% if num_featured_projects > 0 %}
    <section class="featured-projects">
      <h2 class="title">Featured Projects</h2>

      <div class="items" role="presentation">

        {% for item in featured_projects limit:3 %}
          {% assign symbol_path = item.path | split: "/" | slice: 0, 2 | join: "/" | append: "/_includes/symbol.svg" %}
          {% assign relative_symbol_path = "/" | append: symbol_path %}

          <a class="item" href="{{ item.home_url }}" role="article">
            <header>
              <div class="logo-container" role="presentation">
                <div class="logo">{% include {{ relative_symbol_path }} %}</div>
              </div>
              <h3 class="title">{{ item.title }}</h3>
            </header>

            <p class="body">
              {{ item.description }}
            </p>

            <div class="cta-view-project">
              <div class="button">View Project</div>
            </div>
          </a>
        {% endfor %}
      </div>
    </section>
  {% endif %}

  {% assign num_featured_posts = site.posts | size %}
  {% if num_featured_posts > 0 %}
    <section class="featured-posts">
      <div role="presentation" class="puny-label">Latest news</div>
      <h2 class="title">From the Blog</h2>

      <div class="items" role="presentation">
        {% for item in site.posts limit:3 %}
          {% include post-card.html post=item %}
        {% endfor %}
      </div>
    </section>
  {% endif %}
</div>

{% assign other_projects = projects | where: "featured", true %}
{% assign num_other_projects = other_projects | size %}
{% if num_other_projects > 0 %}
<section class="other-projects">
  {% include _includes/symbol.svg %}

  <h2 class="title">Other Projects</h2>

  <div class="items {% if num_other_projects < 5 %}one-row{% endif %}"
      role="presentation">
    {% for item in other_projects %}
      <a class="item" href="{{ item.home_url }}" role="article">
        <header>
          <div class="logo-container" role="presentation">
            <div class="logo">{% include {{ relative_symbol_path }} %}</div>
          </div>
          <h3 class="title">{{ item.title }}</h3>
        </header>

        <p class="body">
          {{ item.description }}
        </p>

        {% include tag-list.html tags=item.tags %}
      </a>
    {% endfor %}
  </div>
</section>
{% endif %}
